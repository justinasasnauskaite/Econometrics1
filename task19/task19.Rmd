---
title: "task19"
author: "Juste"
date: '2016 m lapkritis 28 d '
output: html_document
---

Ákeliami duomenys.

```{r}
train <- read.csv("train.csv")
head(train)
```

Ið pradþiø apsibrëþiu kintamuosius ir paþiûriu , kaip atrodo pateikti duomenys grafike.

```{r}
x<-train$x
y<-train$y
status<-train$status
plot(x[status=="UAB"],y[status=="UAB"], col="brown1", xlab="x", ylab="y", main = "Turimi duomenys")
points(x[status=="II"], y[status=="II"], col="cyan3")
legend ("topleft" , legend=c("su UAB", "su II"), col=c("brown1","cyan3"), pch=c(1,1))
```

Kadangi status kintamieji bus fiktyvûs , turime jiems priskirti reikðmes.
Tegu , kai Status = UAB, reikðmë bus 1, o kai status=II, reikðmë bus 0.

```{r}
k=1
k[status=='II'] = 0
k =(status=='UAB')*1
```

Mûsø regresijs lygtis turëtø bûti tokia:

y=bx+l1k+l2(1-k)

l1, l2 - alfa1, alfa2, atitinkamai

Todël reik apsibrëþti treèià kintamàjá.

```{r}
z=1-k
```

1. Uþduoties dalis

Mûsø modelis:

```{r}
mod<-lm(y~x+k+z-1)
```

Gautos prognozës:

```{r}
ypredicted<-predict(mod, data.frame(x))
plot(x,ypredicted, xlab="x", ylab="y", main="Gautos prognozës ið 'mod'")
```

2. Uþduoties dalis

Kai vertinama nuo status tiesiogiai, nepriskiriant  reiksmiø ir paliekant tai R-ui

```{r}
mod2<-lm(y~x+status)
y2predicted<-predict(mod2,data.frame=(x))
plot(x,y2predicted, xlab="x", ylab="y", main="Gautos prognozës ið 'mod2'")
```

3. Palyginkite dviejø vertinimø rezultatus: R-kvadratà, F statistikà ir paklaidø dispersijà.

```{r}
#summary(mod)
#summary(mod2)
```

Mod:
Paklaidu dispersija (sd error) 0.6797

R kvadratas 0.9881

F statistika 5.513e+04 on 3

Mod2:
Pakl disp (sd error) 0.6797 

R kvadratas 0.979

F statistika 4.653e+04 on 2

Paklaidø standartinis nuokrypis yra vidutinis dydis, kuriuo mûsø priklausomas kintamasis skirsis nuo tikrosios regresijos tiesës. Abiejø modeliø standartinis nuokrypis vienodas. 

Multiple R-squared
Tai matas, skirtas ávertinti modelio tinkamumà stebëjimams.(kaip arti duomenims yra regresijos tiesë) . Kuo didesnis skaièius - tuo modelis geresnis. Vienetas atitinka tobulà modelá, o maþiausia reikðmë - 0.

R-squared = Explained variation / Total variation 

Mod R-squared reikðmë didesnë nei Mod2. Mod paaiðkina daugiau modelio suprognozuotø reikðmiø, nei mod2.

F-statistic
Indikatorius , nusakantis ryðá tarp priklausomo ir nepriklausomo kintamujø. Kuo toliau F-statistic yra nuo 1 , tuo geriau. 

F= explained variation (k-1) / unexplained variation (n-k)

Mod F-statistic yra 55130, o Mod2 46530, taigi Mod reikðmë yra toliau nuo 1, negu Mod2. 

3. Palyginkite modeliø prognozes. 

```{r}
sd(ypredicted-y2predicted)
summary(ypredicted-y2predicted)
```

Min ir Max skirtumø reikðmës maþos, todël standartinis nuokrypis maþas. Santraukoje matome, kad skirtumø vidurkis taip pat labai maþas, todël galima sakyti, kad modeliø prognozës nesiskiria.

4. Duomenys "test" , jø pasiskirstymas.

```{r}
test<-read.csv("test.csv")
head(test)
xt<-test$x
yt<-test$y
statust<-test$status
plot(xt[statust=="UAB"],yt[statust=="UAB"], col="darkseagreen2", xlab="x", ylab="y", main = "Turimi 'test' duomenys")
points(xt[statust=="II"], yt[statust=="II"], col="gold")
legend ("topleft" , legend=c("su UAB", "su II"), col=c("darkseagreen2","gold"), pch=c(1,1))
```

Test duomenø modelis.

```{r}
kt=1
kt[statust=='II'] = 0
kt =(statust=='UAB')*1
zt=1-kt
modt<-lm(yt~xt+kt+zt-1)
ytpredicted<-predict(modt, data.frame(xt))
```

Test duomenø prognozës vaizdas:

```{r}
plot(xt,ytpredicted, main="Gautos 'test' prognozës", xlab="x", ylab="y")
abline(2,1.8, col="darkseagreen2", lwd=3)
abline(4,1.8, col="gold", lwd=3)
legend ("topleft" , legend=c("su UAB", "su II"), col=c("darkseagreen2","gold"), lty=c(1,1))
```

Bendras vaizdas:

```{r}
plot(xt[statust=="UAB"],yt[statust=="UAB"], col="darkseagreen2", xlab="x", ylab="y", main = "Turimi 'test' duomenys ir prognozës")
points(xt[statust=="II"], yt[statust=="II"], col="gold")
abline(2,1.8, col="darkseagreen4", lwd=3)
abline(4,1.8, col="gold3", lwd=3)
legend ("topleft" , legend=c("su UAB (prognoze) ", "su II (prognoze)","su UAB (duomenys) ", "su II (duomenys)"), col=c("darkseagreen4","gold3","darkseagreen2","gold"), lwd=c(3,3, NA , NA), pch=c(NA, NA, 1,1))
```




plotas<- function(x,y) {
d<-x
t<-1.8*d+3
plot(x,y, col=3)
if (y-t<0) {
points(x,y, col=2)
}
}